<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <title>Spring Data JPA 的基本使用 | hemiao3000</title><meta name="description" content="Java Note All in One">
    <link rel="preload" href="/assets/js/runtime~app.98b3ec54.js" as="script"><link rel="preload" href="/assets/css/styles.a89f47c6.css" as="style"><link rel="preload" href="/assets/js/1812.d943ba23.js" as="script"><link rel="preload" href="/assets/js/app.305f9df9.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.a89f47c6.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">hemiao3000</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="环境软件和模板"><span class="title">环境软件和模板</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="环境软件和模板"><span class="title">环境软件和模板</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/windows/01-IDEA.md" class="nav-link" aria-label="Windows"><!--[--><!--]--> Windows <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/linux/00-预备知识.md" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/git/000-安装与配置.md" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/docker/01-简介和安装.md" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/docker-install/01-mysql.md" class="nav-link" aria-label="Docker 安装软件"><!--[--><!--]--> Docker 安装软件 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/gist/01-jdbc-logback.md" class="nav-link" aria-label="各种模板"><!--[--><!--]--> 各种模板 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第一阶段"><span class="title">第一阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第一阶段"><span class="title">第一阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/java/00-环境变量.md" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/mysql/01-操作Database.md" class="nav-link" aria-label="MySQL 数据库"><!--[--><!--]--> MySQL 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/jdbc/01-JDBC基础.md" class="nav-link" aria-label="JDBC 操作数据库"><!--[--><!--]--> JDBC 操作数据库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>进阶</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/java-thread/thread-01-base.md" class="nav-link" aria-label="Java 多线程"><!--[--><!--]--> Java 多线程 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/java8/02-lambda.md" class="nav-link" aria-label="JDK8 新特性"><!--[--><!--]--> JDK8 新特性 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/guava/01-字符串工具类.md" class="nav-link" aria-label="Guava 工具库"><!--[--><!--]--> Guava 工具库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/spring-utils/01-top4.md" class="nav-link" aria-label="Spring 内置工具库"><!--[--><!--]--> Spring 内置工具库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/3rd/01-slf4j.md" class="nav-link" aria-label="其它工具库"><!--[--><!--]--> 其它工具库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>扩展</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/jvm/01-JVM内存布局.md" class="nav-link" aria-label="Java 虚拟机"><!--[--><!--]--> Java 虚拟机 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第二阶段"><span class="title">第二阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第二阶段"><span class="title">第二阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/html/01-基本概念和结构.md" class="nav-link" aria-label="HTML"><!--[--><!--]--> HTML <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/css/01-基本概念.md" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/js/JS-01-基础.md" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><a href="/servlet/Servlet-00-HTTP概述.md" class="nav-link" aria-label="Servlet"><!--[--><!--]--> Servlet <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/junit/JUnit-01-基础.md" class="nav-link" aria-label="JUnit"><!--[--><!--]--> JUnit <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/mybatis/01-mybatis-basics.md" class="nav-link" aria-label="Mybatis"><!--[--><!--]--> Mybatis <!--[--><!--]--></a></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端进阶</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/ajax/01-基础.md" class="nav-link" aria-label="AJAX 请求及相关"><!--[--><!--]--> AJAX 请求及相关 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/vue/vue-00-devtool.md" class="nav-link" aria-label="Vue（上）"><!--[--><!--]--> Vue（上） <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第三阶段"><span class="title">第三阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第三阶段"><span class="title">第三阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>SSM</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/maven/001-基本概念.md" class="nav-link" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring/01-IoC.md" class="nav-link" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring-mvc/001-helloworld.md" class="nav-link" aria-label="Spring MVC"><!--[--><!--]--> Spring MVC <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring-boot/02-Java代码配置.md" class="nav-link" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端高级</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/restful/01-基础.md" class="nav-link" aria-label="RESTful API"><!--[--><!--]--> RESTful API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/vue-cli/vue-cli-01.md" class="nav-link" aria-label="Vue（下）"><!--[--><!--]--> Vue（下） <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/nginx/01-前后端分离.md" class="nav-link" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>权限和其它</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/shiro/01-Shiro-基础.md" class="nav-link" aria-label="Shiro"><!--[--><!--]--> Shiro <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/redis/01-简介.md" class="nav-link" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第四阶段"><span class="title">第四阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第四阶段"><span class="title">第四阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/spring-cloud/01-spring-cloud.md" class="nav-link" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/rabbitmq/01-简介.md" class="nav-link" aria-label="RabbitMQ"><!--[--><!--]--> RabbitMQ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/es/00-素材.md" class="nav-link" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/01-SnowFlake.md" class="nav-link" aria-label="其它"><!--[--><!--]--> 其它 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="环境软件和模板"><span class="title">环境软件和模板</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="环境软件和模板"><span class="title">环境软件和模板</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/windows/01-IDEA.md" class="nav-link" aria-label="Windows"><!--[--><!--]--> Windows <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/linux/00-预备知识.md" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/git/000-安装与配置.md" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/docker/01-简介和安装.md" class="nav-link" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/docker-install/01-mysql.md" class="nav-link" aria-label="Docker 安装软件"><!--[--><!--]--> Docker 安装软件 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/gist/01-jdbc-logback.md" class="nav-link" aria-label="各种模板"><!--[--><!--]--> 各种模板 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第一阶段"><span class="title">第一阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第一阶段"><span class="title">第一阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/java/00-环境变量.md" class="nav-link" aria-label="Java"><!--[--><!--]--> Java <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/mysql/01-操作Database.md" class="nav-link" aria-label="MySQL 数据库"><!--[--><!--]--> MySQL 数据库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/jdbc/01-JDBC基础.md" class="nav-link" aria-label="JDBC 操作数据库"><!--[--><!--]--> JDBC 操作数据库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>进阶</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/java-thread/thread-01-base.md" class="nav-link" aria-label="Java 多线程"><!--[--><!--]--> Java 多线程 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/java8/02-lambda.md" class="nav-link" aria-label="JDK8 新特性"><!--[--><!--]--> JDK8 新特性 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/guava/01-字符串工具类.md" class="nav-link" aria-label="Guava 工具库"><!--[--><!--]--> Guava 工具库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/spring-utils/01-top4.md" class="nav-link" aria-label="Spring 内置工具库"><!--[--><!--]--> Spring 内置工具库 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/utility/3rd/01-slf4j.md" class="nav-link" aria-label="其它工具库"><!--[--><!--]--> 其它工具库 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>扩展</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/jvm/01-JVM内存布局.md" class="nav-link" aria-label="Java 虚拟机"><!--[--><!--]--> Java 虚拟机 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第二阶段"><span class="title">第二阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第二阶段"><span class="title">第二阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端基础</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/html/01-基本概念和结构.md" class="nav-link" aria-label="HTML"><!--[--><!--]--> HTML <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/css/01-基本概念.md" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/js/JS-01-基础.md" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><a href="/servlet/Servlet-00-HTTP概述.md" class="nav-link" aria-label="Servlet"><!--[--><!--]--> Servlet <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/junit/JUnit-01-基础.md" class="nav-link" aria-label="JUnit"><!--[--><!--]--> JUnit <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/mybatis/01-mybatis-basics.md" class="nav-link" aria-label="Mybatis"><!--[--><!--]--> Mybatis <!--[--><!--]--></a></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端进阶</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/ajax/01-基础.md" class="nav-link" aria-label="AJAX 请求及相关"><!--[--><!--]--> AJAX 请求及相关 <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/vue/vue-00-devtool.md" class="nav-link" aria-label="Vue（上）"><!--[--><!--]--> Vue（上） <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第三阶段"><span class="title">第三阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第三阶段"><span class="title">第三阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>SSM</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/maven/001-基本概念.md" class="nav-link" aria-label="Maven"><!--[--><!--]--> Maven <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring/01-IoC.md" class="nav-link" aria-label="Spring"><!--[--><!--]--> Spring <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring-mvc/001-helloworld.md" class="nav-link" aria-label="Spring MVC"><!--[--><!--]--> Spring MVC <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/spring-boot/02-Java代码配置.md" class="nav-link" aria-label="Spring Boot"><!--[--><!--]--> Spring Boot <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>前端高级</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/restful/01-基础.md" class="nav-link" aria-label="RESTful API"><!--[--><!--]--> RESTful API <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/vue-cli/vue-cli-01.md" class="nav-link" aria-label="Vue（下）"><!--[--><!--]--> Vue（下） <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/nginx/01-前后端分离.md" class="nav-link" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="dropdown-item"><!--[--><h4 class="dropdown-subtitle"><span>权限和其它</span></h4><ul class="dropdown-subitem-wrapper"><!--[--><li class="dropdown-subitem"><a href="/shiro/01-Shiro-基础.md" class="nav-link" aria-label="Shiro"><!--[--><!--]--> Shiro <!--[--><!--]--></a></li><li class="dropdown-subitem"><a href="/redis/01-简介.md" class="nav-link" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="第四阶段"><span class="title">第四阶段</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="第四阶段"><span class="title">第四阶段</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/spring-cloud/01-spring-cloud.md" class="nav-link" aria-label="Spring Cloud"><!--[--><!--]--> Spring Cloud <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/rabbitmq/01-简介.md" class="nav-link" aria-label="RabbitMQ"><!--[--><!--]--> RabbitMQ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/es/00-素材.md" class="nav-link" aria-label="ElasticSearch"><!--[--><!--]--> ElasticSearch <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/other/01-SnowFlake.md" class="nav-link" aria-label="其它"><!--[--><!--]--> 其它 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item">Spring Boot</p><ul class=""><li><!--[--><a href="/spring-boot/02-Java%E4%BB%A3%E7%A0%81%E9%85%8D%E7%BD%AE.html" class="nav-link sidebar-item" aria-label="Java 代码配置"><!--[--><!--]--> Java 代码配置 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/01-%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-item" aria-label="SpringBoot 基础"><!--[--><!--]--> SpringBoot 基础 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/03-%E8%87%AA%E5%8A%A8%E9%85%8D%E7%BD%AE.html" class="nav-link sidebar-item" aria-label="自动配置"><!--[--><!--]--> 自动配置 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/04-spring-boot-jsp.html" class="nav-link sidebar-item" aria-label="Spring Boot 项目中使用 JSP"><!--[--><!--]--> Spring Boot 项目中使用 JSP <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/05-thymeleaf%E5%9F%BA%E7%A1%80.html" class="nav-link sidebar-item" aria-label="JSP 的替代者：Thymeleaf"><!--[--><!--]--> JSP 的替代者：Thymeleaf <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/81-spring-boot-jdbc.html" class="nav-link sidebar-item" aria-label="数据源配置"><!--[--><!--]--> 数据源配置 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/06-spring-boot-mybatis.html" class="nav-link sidebar-item" aria-label="SpringBoot 整合 Mybatis"><!--[--><!--]--> SpringBoot 整合 Mybatis <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/15-spring-profiles-active.html" class="nav-link sidebar-item" aria-label="SpringBoot 的多配置文件"><!--[--><!--]--> SpringBoot 的多配置文件 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/11-spring-task.html" class="nav-link sidebar-item" aria-label="Spring Task"><!--[--><!--]--> Spring Task <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/12-spring-boot-mail.html" class="nav-link sidebar-item" aria-label="使用 Spring Boot 开发邮件系统"><!--[--><!--]--> 使用 Spring Boot 开发邮件系统 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/13-spring-boot-swagger.html" class="nav-link sidebar-item" aria-label="Swagger"><!--[--><!--]--> Swagger <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/spring-boot/14-spring-boot-actuator.html" class="nav-link sidebar-item" aria-label="使⽤ Spring Boot Actuator 监控应⽤"><!--[--><!--]--> 使⽤ Spring Boot Actuator 监控应⽤ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="spring-data-jpa-的基本使用" tabindex="-1"><a class="header-anchor" href="#spring-data-jpa-的基本使用" aria-hidden="true">#</a> Spring Data JPA 的基本使用</h1><h2 id="基本概念" tabindex="-1"><a class="header-anchor" href="#基本概念" aria-hidden="true">#</a> 基本概念</h2><h3 id="jpa-由来" tabindex="-1"><a class="header-anchor" href="#jpa-由来" aria-hidden="true">#</a> JPA 由来</h3><blockquote><p>从理论上来说，Mybatis 和 Hibernate 并非同一类框架：Mybatis 是半自动 ORM 框架，而 Hibernate 是全自动的。</p></blockquote><p>而从全自动 ORM 框架的角度来将，Hibernate 也非唯一的一个，跟它同类的竞争对手还有：TopLink、JDO 等<small>（虽然市场占有率十分低）</small> 。</p><p>不同的全自动 ORM 框架<small>（这里并不包括 Mybatis）</small>之间，功能是是相似的，但是 API 接口的区别十分大。不便于项目在底层技术实现之间迁移。</p><p>JPA（Java Persistence API）是 Sun 官方提出的 Java 持久化 <strong>规范</strong>。它的出现主要是为了简化现有的持久化开发工作和整合 ORM 技术，提供统一的 API 接口，结束现在 Hibernate、TopLink、JDO 等 ORM 框架各自为营的局面。</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>JPA 只是一套规范，不是一套产品。JPA 和 Hibernate、TopLink、JDO 之间的关系，就像 slf4j 和 log4j2、logback 之间的关系一样。</p></div><h3 id="spring-data-jpa" tabindex="-1"><a class="header-anchor" href="#spring-data-jpa" aria-hidden="true">#</a> Spring Data JPA</h3><p>一个项目直接<small>（或间接）</small>使用 Hibernate 有三种方式：</p><ol><li><p>直接使用 Hibernate。</p></li><li><p>直接使用 JPA，间接使用 Hibernate；</p></li><li><p>通过 <strong>spring-data-jpa</strong>，将 JPA（和 Hibernate）整合进 Spring 项目，以一种特定的方式<small>（sprig data）</small>使用 JPA，从而间接使用 Hibernate 。</p></li></ol><p>Spring Data JPA 是 Spring 基于 ORM 框架、JPA 规范的基础上封装的一套 JPA 应用框架。如果说，JPA 简化了 Hibernate 的使用，那么 spring-data-jpa 则是在这个基础上再一次简化了 hibernate，提高了开发效率。<small>Spring Data JPA 让我们摆脱了 DAO 层的操作，基本上所有 CRUD 都可以依赖于它实现。</small></p><p>Spring Data JPA 其实就是要求在 Spirng Data 的体系下使用 JPA。<small>Spring Data JPA 只是 Spring Data 体系中的一员。</small></p><h2 id="快速上手" tabindex="-1"><a class="header-anchor" href="#快速上手" aria-hidden="true">#</a> 快速上手</h2><h3 id="添加依赖" tabindex="-1"><a class="header-anchor" href="#添加依赖" aria-hidden="true">#</a> 添加依赖</h3><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="添加配置文件" tabindex="-1"><a class="header-anchor" href="#添加配置文件" aria-hidden="true">#</a> 添加配置文件</h3><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://127.0.0.1:3306/scott\
    ?useUnicode=true\
    &amp;characterEncoding=utf-8\
    &amp;useSSL=true\
    &amp;serverTimezone=UTC</span>
<span class="token attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">root</span>
<span class="token attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">123456</span>

<span class="token attr-name">spring.jpa.show-sql</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
<span class="token attr-name">spring.jpa.properties.hibernate.dialect</span><span class="token punctuation">=</span><span class="token attr-value">org.hibernate.dialect.MySQL5Dialect</span>
<span class="token attr-name">spring.jpa.properties.hibernate.format_sql</span><span class="token punctuation">=</span><span class="token attr-value">true</span>
<span class="token attr-name">spring.jpa.properties.hibernate.hbm2ddl.auto</span><span class="token punctuation">=</span><span class="token attr-value">update</span>

<span class="token attr-name">logging.level.root</span><span class="token punctuation">=</span><span class="token attr-value">INFO</span>
<span class="token attr-name">logging.level.xxx.yyy.zzz</span><span class="token punctuation">=</span><span class="token attr-value">DEBUG</span>
<span class="token attr-name">logging.pattern.console</span><span class="token punctuation">=</span><span class="token attr-value">${CONSOLE_LOG_PATTERN:\
  %clr(${LOG_LEVEL_PATTERN:%5p}) \
  %clr(|){faint} \
  %clr(%-40.40logger{39}){cyan} \
  %clr(:){faint} %m%n\
  ${LOG_EXCEPTION_CONVERSION_WORD:%wEx}}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong><code>hibernate.hbm2ddl.auto</code></strong> 参数的作用主要用于：自动创建、更新、验证数据库表结构，有四个值。</p><table><thead><tr><th style="text-align:left;">值</th><th style="text-align:left;">说明</th></tr></thead><tbody><tr><td style="text-align:left;"><code>create</code></td><td style="text-align:left;">每次启动项目都会删除上一次创建的 Table，再根据配置重新创建 Table 。<small>这种方式会导致数据库表数据丢失。</small></td></tr><tr><td style="text-align:left;"><code>create-drop</code></td><td style="text-align:left;">本质上和 <code>create</code> 一样，只不过是本次项目结束时就删除 Table 。<small>不用等到下次启动时再删除。</small></td></tr><tr><td style="text-align:left;"><strong><code>update</code></strong></td><td style="text-align:left;"><small>最常用。</small>会以 Model 类的配置为依据，在没有表时建表，在表中没有某列时，新增列。每次启动时都是如此。</td></tr><tr><td style="text-align:left;"><code>validate</code></td><td style="text-align:left;">每次加载 Hibernate 时，会以 Model 类的配置来验证数据库中的表结构，两者必须严格一直<small>（char 和 varchar 都算不一致）</small>。这个过程中不会创建、更新新表。如果不一致会报错。</td></tr></tbody></table><blockquote><p><strong><code>update</code></strong> 对数据库表结构的『更新』仅限于：</p><ul><li>根据 Model 创建一个原本不存在的 Table；</li><li>为已存在的 Table『新增』列。</li></ul><p>不包括</p><ul><li>修改已有列的数据类型；</li><li>新增或修改已有列的约束条件；</li><li>删除 Table 的某列。</li></ul></blockquote><h3 id="开启-jpa-框架功能" tabindex="-1"><a class="header-anchor" href="#开启-jpa-框架功能" aria-hidden="true">#</a> 开启 JPA 框架功能</h3><p>在某个配置类（或入口类）上加上 <em><strong><code>@EnableJpaRepositories(basePackages = &quot;xxx.yyy.zzz.dao&quot;)</code></strong></em> 注解。</p><blockquote><p>经测试，这一步并非必须。不加时 Spring Boot 也会自动启动 JPA 框架功能。而且，默认会扫描入口类平级及下级包，看哪个类『脑袋』上有 <em><strong><code>@Repository</code></strong></em> 注解。</p></blockquote><h3 id="实体类" tabindex="-1"><a class="header-anchor" href="#实体类" aria-hidden="true">#</a> 实体类</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">/*
 * DBMS   - catalog  - schema   - table
 * Mysql  - &lt;no&gt;     - database - table
 * Oracle - database - &lt;no&gt;     - table
 */</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">&quot;表名&quot;</span><span class="token punctuation">,</span> schema <span class="token operator">=</span><span class="token string">&quot;数据库名&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token punctuation">{</span>

  <span class="token annotation punctuation">@Id</span>
  <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> unique <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token class-name">String</span> location<span class="token punctuation">;</span>

  <span class="token comment">// getter / settet ...</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><ul><li><p>由于默认配置的存在，上述示例省略了默写配置<small>（后续会讲解）</small>。</p></li><li><p><code>@Entity(name=&quot;EntityName&quot;)</code> <strong>必须</strong></p><p>用来标注一个数据库对应的实体，数据库中创建的表名默认和类名一致。其中，name 为可选，对应数据库中一个表，使用此注解标记 JavaBean 是一个 JPA 实体。</p></li><li><p><code>@Table(name=&quot;&quot;, catalog=&quot;&quot;, schema=&quot;&quot;)</code> <em>可选</em></p><p>用来标注一个数据库对应的实体，数据库中创建的表名默认和类名一致。通常和 <code>@Entity</code> 配合使用，只能标注在实体的 class 定义处，表示实体对应的数据库表的信息。</p><p>在数据库理论领域中，DBMS - Catalog - Schema - Table 是四级概念，但不是所有的数据库系统都支持这四级。MySql 就不支持其中的 catalog ，而 schema 就是 mysql 中的 database 。</p></li><li><p><code>@Id</code> <strong>必须</strong></p><p><code>@Id</code> 定义了映射到数据库表的主键的属性，一个实体只能有一个属性被映射为主键。</p></li><li><p><code>@GeneratedValue(strategy=GenerationType, generator=&quot;&quot;)</code> <em>可选</em></p><ul><li><p><code>strategy</code>：表示主键生成策略,有 <code>AUTO</code>、<code>INDENTITY</code>、<code>SEQUENCE</code> 和 <code>TABLE</code> 4 种。</p></li><li><p><code>generator</code>：表示主键生成器的名称。</p></li></ul></li><li><p><code>@Column(name=&quot;user_code&quot;, nullable=false, length=32)</code> <em>可选</em></p><p><code>@Column</code> 描述了数据库表中该字段的详细定义，这对于根据 JPA 注解生成数据库表结构的工具。</p><ul><li><p><code>name</code>：表示数据库表中该字段的名称，默认情形属性名称一致;</p></li><li><p><code>nullable</code>：表示该字段是否允许为 null，默认为 true;</p></li><li><p><code>unique</code>：表示该字段是否是唯一标识，默认为 false;</p></li><li><p><code>length</code>：表示该字段的大小，仅对 String 类型的字段有效。</p></li></ul></li><li><p><code>@Transient</code> <em>可选</em></p><p><code>@Transient</code> 表示该属性并非一个到数据库表的字段的映射，ORM 框架将忽略该属性。</p></li></ul><blockquote><p>另外，<em>@Enumerated</em> 和 <em>@Enumerated</em> 注解在某些场景下可能也会用到。</p></blockquote><p>这些标注于属性上的注解，也可以标注在属性的 get 方法上。注意，不是/不用标注在 set 方法上。</p><h2 id="uuid-和-assigned-主键策略-了解、自学" tabindex="-1"><a class="header-anchor" href="#uuid-和-assigned-主键策略-了解、自学" aria-hidden="true">#</a> UUID 和 ASSIGNED 主键策略（了解、自学）</h2><p>通常 JPA『背后』是 Hibernate，而 Hibernate 除了和上述的一样的 <strong><code>identity</code></strong>、<strong><code>sequence</code></strong> 主键生成策略之外，还有 <strong><code>uuid</code></strong> 和 <strong><code>assigend</code></strong> 两种主键生成策略。</p><p>在 JPA 中使用 Hibernate 的 <strong><code>uuid</code></strong> 和 <strong><code>assigend</code></strong> 策略，需要【多】使用一个注解：<em><strong><code>@GenericGenerator</code></strong></em> 。</p><ul><li><p>strategy = &quot;uuid&quot;：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Id</span>
<span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">&quot;uuid&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li><li><p>strategy = &quot;assigend&quot;：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Id</span>
<span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>generator <span class="token operator">=</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GenericGenerator</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;yyy&quot;</span><span class="token punctuation">,</span> strategy <span class="token operator">=</span> <span class="token string">&quot;assigned&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul><h2 id="repository-构建" tabindex="-1"><a class="header-anchor" href="#repository-构建" aria-hidden="true">#</a> Repository 构建</h2><blockquote><p>提前声明一点，如果要在 JUnit 中测试 Repository，记得使用 <strong><code>@Transactionl</code></strong> 注解。否则会报错：no session 。</p></blockquote><p>自定义的 <em><strong><code>Repository</code></strong></em> 只要继承 <em><strong><code>JpaRepository</code></strong></em> 即可，就会帮我们自动生成很多内置方法。这是 spring-data-jpa 为我们带来的便利！</p><p>父接口 JpaRepository 要求传入两个泛型参数：</p><ul><li><p>第一个泛型参数是自定义的 Repository 所操作的 <em><code>@Entity</code></em> ；</p></li><li><p>第二个泛型参数是 Entity 的 <em><code>@Id</code></em> 属性类型。</p></li></ul><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Repository</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><img src="https://hemiao3000.gitee.io/java-note-img/images/spring-boot/img/spring-boot-data-jpa-JpaRepository.png" alt="JpaRepository"></p><p><em><strong><code>JpaRepository</code></strong></em> 继承 PagingAndSortingRepository 和 QueryByExampleExecutor。PagingAndSortingRepository 又继承了 CrudRepository 。</p><table><thead><tr><th style="text-align:left;">祖先</th><th style="text-align:left;">作用</th></tr></thead><tbody><tr><td style="text-align:left;">CrudRepository</td><td style="text-align:left;">内置了我们最常用的增、删、改、查的方法。</td></tr><tr><td style="text-align:left;">PagingAndSortingRepository</td><td style="text-align:left;">在 CrudRepository 基础上负责排序和分⻚</td></tr><tr><td style="text-align:left;">QueryByExampleExecutor</td><td style="text-align:left;">提供了很多示例的查询方法。</td></tr></tbody></table><p>因此使用 JPA 操作数据库时，只需要构建的 Repository 继承了 <em><strong><code>JpaRepository</code></strong></em>，就会拥有了很多常用的数据库操作方法。常用的方法有：</p><ul><li><p>增/改</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>repository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>添加和修改功能都是使用 <em><code>.save()</code></em> 方法。</p><p>有一点需要注意的是，对于修改而言，要先执行查询，再对查询到的 Entity 进行修改，而后再调用 <em><code>.save()</code></em> 方法。</p></li><li><p>删</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>repository<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
repository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>删除常见两种：先执行查询，再对查询到的 Entity 调用 <em><code>.delete</code></em> 方法进行删除；另一种是直接提供 Entity 的 ID 进行删除。</p></li><li><p>查</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code>repository<span class="token punctuation">.</span><span class="token function">getOne</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
repository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><em><code>.getOne()</code></em> 和 <em><code>findById()</code></em> 都是根据 ID 进行查询。区别在于：查不到时，<em><code>.getOne()</code></em> 抛出 <em><strong><code>EntityNotFoundException</code></strong></em> 异常，而 <em><code>.findById()</code></em> 查不查得到都是返回 <em><strong><code>Optional&lt;&gt;</code></strong></em> 。</p><p>补充一点，在 Repository 的继承体系中 QueryByExampleExecutor 提供了通过 Example 对象进行条件查询。不过，它用起来还是相对比较繁琐，因此，通常使用的是其它方案来实现各种条件查询。这也是 spring-data-jpa 对 JPA 的改进之处。</p></li></ul><h2 id="自定义简单的条件查询" tabindex="-1"><a class="header-anchor" href="#自定义简单的条件查询" aria-hidden="true">#</a> 自定义简单的条件查询</h2><p>spring-data-jap 还有一个功能非常实用：可以根据方法名自动生产 SQL。比如 <em><code>.findByUserName()</code></em> 会自动生产一个以 <code>userName</code> 为参数的查询方法。只需要在我们自定义的 Repository 中创建好方法，使用的时候直接将接口注入到类中调用即可。</p><ul><li><p>根据用户名查询用户：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">User</span> <span class="token function">findByUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>也可以加一些关键字 And、or：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">User</span> <span class="token function">findByUserNameOrEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> username， <span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div></li><li><p>修改、删除、统计也是类似语法：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Long</span> <span class="token function">deleteByUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Long</span> <span class="token function">countByUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li><li><p>基本上 SQL 体系中的关键词都可以使用，如 LIKE 、IgnoreCase、OrderBy：</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByEmailLike</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token class-name">User</span> <span class="token function">findByUserNameIgnoreCase</span><span class="token punctuation">(</span><span class="token class-name">String</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByUserNameOrderByEmailDesc</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul><p>可以根据查询的条件不断地添加和拼接，Spring Boot 都可以正确解析和执行，其他使用示例例可以参考下表。</p><p><strong>具体的关键字，使用方法和生产成 SQL 如下表所示</strong></p><table><thead><tr><th style="text-align:left;">Keyword</th><th style="text-align:left;">Sample</th><th style="text-align:left;">JPQL snippet</th></tr></thead><tbody><tr><td style="text-align:left;">And</td><td style="text-align:left;">findByLastnameAndFirstname</td><td style="text-align:left;">… where x.lastname = ?1 and x.firstname = ?2</td></tr><tr><td style="text-align:left;">Or</td><td style="text-align:left;">findByLastnameOrFirstname</td><td style="text-align:left;">… where x.lastname = ?1 or x.firstname = ?2</td></tr><tr><td style="text-align:left;">Is, Equals</td><td style="text-align:left;">findByFirstnameIs, <br>findByFirstnameEquals</td><td style="text-align:left;">… where x.firstname = ?1</td></tr><tr><td style="text-align:left;">Between</td><td style="text-align:left;">findByStartDateBetween</td><td style="text-align:left;">… where x.startDate between ?1 and ?2</td></tr><tr><td style="text-align:left;">LessThan</td><td style="text-align:left;">findByAgeLessThan</td><td style="text-align:left;">… where x.age &lt; ?1</td></tr><tr><td style="text-align:left;">LessThanEqual</td><td style="text-align:left;">findByAgeLessThanEqual</td><td style="text-align:left;">… where x.age &lt;= ?1</td></tr><tr><td style="text-align:left;">GreaterThan</td><td style="text-align:left;">findByAgeGreaterThan</td><td style="text-align:left;">… where x.age &gt; ?1</td></tr><tr><td style="text-align:left;">GreaterThanEqual</td><td style="text-align:left;">findByAgeGreaterThanEqual</td><td style="text-align:left;">… where x.age &gt;= ?1</td></tr><tr><td style="text-align:left;">After</td><td style="text-align:left;">findByStartDateAfter</td><td style="text-align:left;">… where x.startDate &gt; ?1</td></tr><tr><td style="text-align:left;">Before</td><td style="text-align:left;">findByStartDateBefore</td><td style="text-align:left;">… where x.startDate &lt; ?1</td></tr><tr><td style="text-align:left;">IsNull</td><td style="text-align:left;">findByAgeIsNull</td><td style="text-align:left;">… where x.age is null</td></tr><tr><td style="text-align:left;">IsNotNull, NotNull</td><td style="text-align:left;">findByAge(Is)NotNull</td><td style="text-align:left;">… where x.age not null</td></tr><tr><td style="text-align:left;">Like</td><td style="text-align:left;">findByFirstnameLike</td><td style="text-align:left;">… where x.firstname like ?1</td></tr><tr><td style="text-align:left;">NotLike</td><td style="text-align:left;">findByFirstnameNotLike</td><td style="text-align:left;">… where x.firstname not like ?1</td></tr><tr><td style="text-align:left;">StartingWith</td><td style="text-align:left;">findByFirstnameStartingWith</td><td style="text-align:left;">… where x.firstname like ?1 (parameter bound with appended %)</td></tr><tr><td style="text-align:left;">EndingWith</td><td style="text-align:left;">findByFirstnameEndingWith</td><td style="text-align:left;">… where x.firstname like ?1 (parameter bound with prepended %)</td></tr><tr><td style="text-align:left;">Containing</td><td style="text-align:left;">findByFirstnameContaining</td><td style="text-align:left;">… where x.firstname like ?1 (parameter bound wrapped in %)</td></tr><tr><td style="text-align:left;">OrderBy</td><td style="text-align:left;">findByAgeOrderByLastnameDesc</td><td style="text-align:left;">… where x.age = ?1 order by x.lastname desc</td></tr><tr><td style="text-align:left;">Not</td><td style="text-align:left;">findByLastnameNot</td><td style="text-align:left;">… where x.lastname &lt;&gt; ?1</td></tr><tr><td style="text-align:left;">In</td><td style="text-align:left;">findByAgeIn(Collection ages)</td><td style="text-align:left;">… where x.age in ?1</td></tr><tr><td style="text-align:left;">NotIn</td><td style="text-align:left;">findByAgeNotIn(Collection age)</td><td style="text-align:left;">… where x.age not in ?1</td></tr><tr><td style="text-align:left;">TRUE</td><td style="text-align:left;">findByActiveTrue()</td><td style="text-align:left;">… where x.active = true</td></tr><tr><td style="text-align:left;">FALSE</td><td style="text-align:left;">findByActiveFalse()</td><td style="text-align:left;">… where x.active = false</td></tr><tr><td style="text-align:left;">IgnoreCase</td><td style="text-align:left;">findByFirstnameIgnoreCase</td><td style="text-align:left;">… where UPPER(x.firstame) = UPPER(?1)</td></tr></tbody></table><p>『The End』</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/8/23 下午5:35:44</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: hemiao3000@126.com">hemiao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.98b3ec54.js" defer></script><script src="/assets/js/1812.d943ba23.js" defer></script><script src="/assets/js/app.305f9df9.js" defer></script>
  </body>
</html>
