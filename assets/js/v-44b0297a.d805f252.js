"use strict";(self.webpackChunkjava_note_vuepress2=self.webpackChunkjava_note_vuepress2||[]).push([[3970],{65124:(n,a,s)=>{s.r(a),s.d(a,{data:()=>e});const e={key:"v-44b0297a",path:"/gist/10-spring-cloud-eureka.html",title:"Eureka 的 application 配置",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"Eureka Server",slug:"eureka-server",children:[]},{level:2,title:"Eureka Client",slug:"eureka-client",children:[]}],filePathRelative:"gist/10-spring-cloud-eureka.md",git:{updatedTime:1629711344e3,contributors:[{name:"hemiao",email:"hemiao3000@126.com",commits:1}]}}},49878:(n,a,s)=>{s.r(a),s.d(a,{default:()=>p});const e=(0,s(66252).uE)('<h1 id="eureka-的-application-配置" tabindex="-1"><a class="header-anchor" href="#eureka-的-application-配置" aria-hidden="true">#</a> Eureka 的 application 配置</h1><h2 id="eureka-server" tabindex="-1"><a class="header-anchor" href="#eureka-server" aria-hidden="true">#</a> Eureka Server</h2><ul><li><p>application.yml 版</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>\n  <span class="token key atrule">application</span><span class="token punctuation">:</span>\n    <span class="token key atrule">name</span><span class="token punctuation">:</span> eureka<span class="token punctuation">-</span>server<span class="token punctuation">-</span>registry\n<span class="token key atrule">server</span><span class="token punctuation">:</span>\n  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8761</span>\n<span class="token key atrule">eureka</span><span class="token punctuation">:</span>\n  <span class="token key atrule">instance</span><span class="token punctuation">:</span>\n    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.cloud.client.ip<span class="token punctuation">-</span>address<span class="token punctuation">}</span>\n    <span class="token key atrule">instanceId</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>eureka.instance.hostname<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>\n    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>\n  <span class="token key atrule">client</span><span class="token punctuation">:</span>\n    <span class="token key atrule">fetchRegistry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>\n    <span class="token key atrule">registerWithEureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>\n    <span class="token key atrule">serviceUrl</span><span class="token punctuation">:</span>\n      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>/eureka\n  <span class="token key atrule">server</span><span class="token punctuation">:</span>\n    <span class="token key atrule">enable-self-preservation</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>\n\n<span class="token key atrule">logging</span><span class="token punctuation">:</span>\n  <span class="token key atrule">level</span><span class="token punctuation">:</span>\n    <span class="token key atrule">root</span><span class="token punctuation">:</span> WARN\n    <span class="token key atrule">com.woniu</span><span class="token punctuation">:</span> DEBUG\n    <span class="token key atrule">com.example</span><span class="token punctuation">:</span> DEBUG\n  <span class="token key atrule">pattern</span><span class="token punctuation">:</span>\n    <span class="token key atrule">console</span><span class="token punctuation">:</span> &quot;$<span class="token punctuation">{</span>CONSOLE_LOG_PATTERN<span class="token punctuation">:</span>\\\n      <span class="token directive important">%clr(${LOG_LEVEL_PATTERN:%5p}) \\</span>\n      <span class="token directive important">%clr([%15.15t]){faint} \\</span>\n      <span class="token directive important">%clr(%-40.40logger{39}){cyan} \\</span>\n      <span class="token directive important">%clr(:){faint} \\</span>\n      <span class="token directive important">%m%n${LOG_EXCEPTION_CONVERSION_WORD:%wEx}}&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div></li><li><p>application.properties</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token attr-value">eureka-server-registry</span>\n<span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8761</span>\n<span class="token attr-name">eureka.instance.hostname</span><span class="token punctuation">=</span><span class="token attr-value">${spring.cloud.client.ip-address}</span>\n<span class="token attr-name">eureka.instance.instanceId</span><span class="token punctuation">=</span><span class="token attr-value">${eureka.instance.hostname}:${server.port}</span>\n<span class="token attr-name">eureka.instance.prefer-ip-address</span><span class="token punctuation">=</span><span class="token attr-value">true</span>\n<span class="token attr-name">eureka.client.fetchRegistry</span><span class="token punctuation">=</span><span class="token attr-value">false</span>\n<span class="token attr-name">eureka.client.registerWithEureka</span><span class="token punctuation">=</span><span class="token attr-value">false</span>\n<span class="token attr-name">eureka.client.serviceUrl.defaultZone</span><span class="token punctuation">=</span><span class="token attr-value">http://127.0.0.1:${server.port}/eureka</span>\n<span class="token attr-name">eureka.server.enable-self-preservation</span><span class="token punctuation">=</span><span class="token attr-value">false</span>\n<span class="token attr-name">logging.level.root</span><span class="token punctuation">=</span><span class="token attr-value">WARN</span>\n<span class="token attr-name">logging.level.com.woniu</span><span class="token punctuation">=</span><span class="token attr-value">DEBUG</span>\n<span class="token attr-name">logging.level.com.example</span><span class="token punctuation">=</span><span class="token attr-value">DEBUG</span>\n<span class="token attr-name">logging.pattern.console</span><span class="token punctuation">=</span><span class="token attr-value">${CONSOLE_LOG_PATTERN:%clr(${LOG_LEVEL_PATTERN:%5p}) %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:%wEx}}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul><h2 id="eureka-client" tabindex="-1"><a class="header-anchor" href="#eureka-client" aria-hidden="true">#</a> Eureka Client</h2><ul><li><p>application.yml 版：</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>\n  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>\n<span class="token key atrule">spring</span><span class="token punctuation">:</span>\n  <span class="token key atrule">application</span><span class="token punctuation">:</span>\n    <span class="token key atrule">name</span><span class="token punctuation">:</span> service<span class="token punctuation">-</span>producer\n<span class="token key atrule">eureka</span><span class="token punctuation">:</span>\n  <span class="token key atrule">instance</span><span class="token punctuation">:</span>\n    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>spring.cloud.client.ip<span class="token punctuation">-</span>address<span class="token punctuation">}</span>\n    <span class="token key atrule">instanceId</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>eureka.instance.hostname<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>server.port<span class="token punctuation">}</span>\n    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>\n    <span class="token key atrule">lease-renewal-interval-in-seconds</span><span class="token punctuation">:</span> <span class="token number">4</span>\n    <span class="token key atrule">lease-expiration-duration-in-seconds</span><span class="token punctuation">:</span> <span class="token number">12</span>\n  <span class="token key atrule">client</span><span class="token punctuation">:</span>\n    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>\n      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//127.0.0.1<span class="token punctuation">:</span>8761/eureka/\n\n<span class="token key atrule">management</span><span class="token punctuation">:</span>\n  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>\n    <span class="token key atrule">web</span><span class="token punctuation">:</span>\n      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>\n        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&quot;*&quot;</span>\n       <span class="token comment">#include: refresh,health,hystrix.stream</span>\n  <span class="token key atrule">endpoint</span><span class="token punctuation">:</span>\n    <span class="token key atrule">health</span><span class="token punctuation">:</span>\n      <span class="token key atrule">show-details</span><span class="token punctuation">:</span> always\n\n<span class="token key atrule">logging</span><span class="token punctuation">:</span>\n  <span class="token key atrule">level</span><span class="token punctuation">:</span>\n    <span class="token key atrule">root</span><span class="token punctuation">:</span> WARN\n    <span class="token key atrule">com.woniu</span><span class="token punctuation">:</span> DEBUG\n  <span class="token key atrule">pattern</span><span class="token punctuation">:</span>\n    <span class="token key atrule">console</span><span class="token punctuation">:</span> &quot;$<span class="token punctuation">{</span>CONSOLE_LOG_PATTERN<span class="token punctuation">:</span>\\\n      <span class="token directive important">%clr(${LOG_LEVEL_PATTERN:%5p}) \\</span>\n      <span class="token directive important">%clr([%15.15t]){faint} \\</span>\n      <span class="token directive important">%clr(%-40.40logger{39}){cyan} \\</span>\n      <span class="token directive important">%clr(:){faint} \\</span>\n      <span class="token directive important">%m%n${LOG_EXCEPTION_CONVERSION_WORD:%wEx}}&quot;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div></li><li><p>application.properties 版</p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8080</span>\n<span class="token attr-name">spring.application.name</span><span class="token punctuation">=</span><span class="token attr-value">service-producer</span>\n<span class="token attr-name">eureka.instance.hostname</span><span class="token punctuation">=</span><span class="token attr-value">${spring.cloud.client.ip-address}</span>\n<span class="token attr-name">eureka.instance.instanceId</span><span class="token punctuation">=</span><span class="token attr-value">${eureka.instance.hostname}:${server.port}</span>\n<span class="token attr-name">eureka.instance.prefer-ip-address</span><span class="token punctuation">=</span><span class="token attr-value">true</span>\n<span class="token attr-name">eureka.instance.lease-renewal-interval-in-seconds</span><span class="token punctuation">=</span><span class="token attr-value">4</span>\n<span class="token attr-name">eureka.instance.lease-expiration-duration-in-seconds</span><span class="token punctuation">=</span><span class="token attr-value">12</span>\n<span class="token attr-name">eureka.client.service-url.defaultZone</span><span class="token punctuation">=</span><span class="token attr-value">http://127.0.0.1:8761/eureka/</span>\n\n<span class="token attr-name">management.endpoints.web.exposure.include</span><span class="token punctuation">=</span><span class="token attr-value">*</span>\n<span class="token comment">#management.endpoints.web.exposure.include=refresh,health,hystrix.stream</span>\n<span class="token attr-name">management.endpoint.health.show-details</span><span class="token punctuation">=</span><span class="token attr-value">always</span>\n\n<span class="token attr-name">logging.level.root</span><span class="token punctuation">=</span><span class="token attr-value">WARN</span>\n<span class="token attr-name">logging.level.com.woniu</span><span class="token punctuation">=</span><span class="token attr-value">DEBUG</span>\n<span class="token attr-name">logging.pattern.console</span><span class="token punctuation">=</span><span class="token attr-value">${CONSOLE_LOG_PATTERN:%clr(${LOG_LEVEL_PATTERN:%5p}) %clr([%15.15t]){faint} %clr(%-40.40logger{39}){cyan} %clr(:){faint} %m%n${LOG_EXCEPTION_CONVERSION_WORD:%wEx}}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></li></ul>',5),p={render:function(n,a){return e}}}}]);